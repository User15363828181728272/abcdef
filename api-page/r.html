<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XTE SECURE REQUEST</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Space+Grotesk:wght@500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* CSS tetap sama mewahnya dengan sebelumnya */
        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; }
        :root { --primary: #FF4500; --secondary: #0A0A0A; --bg: #FFFFFF; --card-bg: #F9F9FB; --ease: cubic-bezier(0.23, 1, 0.32, 1); }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: #0A0A0A; -webkit-font-smoothing: antialiased; }
        .nav-glass { position: fixed; top: 15px; left: 50%; transform: translateX(-50%); width: calc(100% - 30px); max-width: 1200px; height: 60px; background: rgba(255,255,255,0.85); backdrop-filter: blur(25px); border: 1px solid rgba(0,0,0,0.05); border-radius: 20px; z-index: 1000; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); }
        .brand { display: flex; align-items: center; gap: 10px; text-decoration: none; color: var(--secondary); font-family: 'Space Grotesk', sans-serif; font-weight: 800; }
        .request-header { padding: 120px 20px 30px; max-width: 1200px; margin: 0 auto; text-align: center; }
        .request-title { font-family: 'Space Grotesk', sans-serif; font-size: clamp(32px, 10vw, 64px); font-weight: 800; line-height: 1; letter-spacing: -2px; }
        .request-title span { color: transparent; -webkit-text-stroke: 1px var(--secondary); }
        .form-container { max-width: 800px; margin: 0 auto 100px; padding: 0 15px; }
        .request-card { background: var(--card-bg); border-radius: 30px; padding: 30px; border: 1px solid rgba(0,0,0,0.05); }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; font-size: 11px; font-weight: 800; text-transform: uppercase; margin-bottom: 8px; }
        .input-field { width: 100%; background: white; border: 1px solid rgba(0,0,0,0.08); border-radius: 15px; padding: 15px; font-family: inherit; transition: var(--ease); }
        .input-field:focus { border-color: var(--primary); }
        textarea.input-field { min-height: 180px; font-family: 'JetBrains Mono', monospace; font-size: 12px; }
        .submit-btn { width: 100%; height: 60px; background: var(--secondary); color: white; border: none; border-radius: 18px; font-weight: 800; text-transform: uppercase; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: var(--ease); }
        .submit-btn:hover { background: var(--primary); transform: translateY(-3px); }
        .status-box { margin-top: 25px; background: #000; border-radius: 20px; display: none; flex-direction: column; height: 300px; overflow: hidden; }
        .status-nav { padding: 12px 15px; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; }
        .status-scroll { overflow: auto; flex-grow: 1; padding: 15px; cursor: move; }
        pre { color: #00FF00; font-family: 'JetBrains Mono', monospace; font-size: 11px; }
        .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); background: var(--secondary); color: white; padding: 15px 30px; border-radius: 20px; font-weight: 800; font-size: 11px; z-index: 9999; transition: 0.5s; }
        .toast.visible { transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body>

    <nav class="nav-glass">
        <div class="brand">
            <i class="material-icons" style="color: var(--primary)">shield</i>
            <span>Request <span>Endepoint</span></span>
        </div>
    </nav>

    <header class="request-header">
        <h1 class="request-title">XTE ID <br><span>REQUEST.</span></h1>
    </header>

    <div class="form-container">
        <div class="request-card">
            <form id="requestForm" onsubmit="return false">
                <div class="input-group">
                    <label>Nama Endpoint / Fitur</label>
                    <input type="text" id="featName" class="input-field" placeholder="Ketik nama fitur..." required>
                </div>
                <div class="input-group">
                    <label>Detail / Scraper Code</label>
                    <textarea id="featDetail" class="input-field" placeholder="Tempel kode atau deskripsi rahasia kamu..." required></textarea>
                </div>
                <button type="submit" class="submit-btn" id="submitBtn" onclick="sendSecurePush()">
                    <i class="material-icons">send</i>
                    Send Request
                </button>
            </form>

            <div class="status-box" id="statusBox">
                <div class="status-nav">
                    <span style="color:#00FF00; font-size:10px; font-weight:900;">ENCRYPTED LOG</span>
                </div>
                <div class="status-scroll" id="scrollContainer" onmousedown="startDrag(event, this)">
                    <pre id="outputLog"></pre>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast">Data Terkirim!</div>

    <script>
        async function sendSecurePush() {
            const name = document.getElementById('featName').value;
            const detail = document.getElementById('featDetail').value;
            const log = document.getElementById('outputLog');
            const box = document.getElementById('statusBox');

            if(!name || !detail) return;

            box.style.display = 'flex';
            log.textContent = `[SYSTEM] Initiating Secure Handshake...\n`;
            
            try {
                
                const res = await fetch('/api/request', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        name, 
                        type: 'SECURE_REQUEST', 
                        detail 
                    })
                });

                log.textContent += `[INFO] Sending payload to internal server...\n`;
                const result = await res.json();

                if(result.ok) {
                    log.textContent += `[SUCCESS] Server processed request.\n`;
                    log.textContent += `[SUCCESS] Telegram Bot notified via Secure Bridge.\n`;
                    document.getElementById('toast').classList.add('visible');
                    setTimeout(() => document.getElementById('toast').classList.remove('visible'), 3000);
                } else {
                    log.textContent += `[ERROR] Server Refused: ${result.description}\n`;
                }
            } catch (e) {
                log.textContent += `[FATAL] Bridge Error: ${e.message}\n`;
            }
        }

        function startDrag(e, container) {
            container.isDown = true;
            container.startX = e.pageX - container.offsetLeft;
            container.startY = e.pageY - container.offsetTop;
            container.scrollLeftInit = container.scrollLeft;
            container.scrollTopInit = container.scrollTop;
            const move = (ev) => {
                if (!container.isDown) return;
                ev.preventDefault();
                container.scrollLeft = container.scrollLeftInit - (ev.pageX - container.offsetLeft - container.startX);
                container.scrollTop = container.scrollTopInit - (ev.pageY - container.offsetTop - container.startY);
            };
            const end = () => { container.isDown = false; window.removeEventListener('mousemove', move); };
            window.addEventListener('mousemove', move);
            window.addEventListener('mouseup', end);
        }
    </script>
</body>
</html>
